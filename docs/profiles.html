<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clone Hero Color Profiles</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
  }
  h1 { text-align: center; }
  #index { margin-bottom: 10px; }
  #index button {
    margin: 2px; padding: 5px 8px;
    cursor: pointer;
  }
  .profile-row {
    display: flex; align-items: center; margin: 5px 0;
  }
  .profile-name {
    width: 150px;
    margin-right: 10px;
    font-weight: bold;
  }
  .swatch {
    width: 50px; height: 30px; margin-right: 2px;
    border: 1px solid #333;
    display: flex; align-items: center; justify-content: center;
    color: white; font-weight: bold;
  }
  #comparison {
    margin-top: 20px;
    border-top: 2px solid #333; padding-top: 10px;
  }
  #comparison h2 { margin-bottom: 5px; }
  #comparison .selected-profiles {
    display: flex; gap: 10px; flex-wrap: wrap;
  }
  .compare-row {
    display: flex; flex-direction: column; align-items: center;
  }
  .compare-row .swatch { width: 60px; height: 40px; margin: 2px 0; }
</style>
</head>
<body>
<h1>Clone Hero Color Profiles</h1>

<div id="index"></div>

<div id="profiles"></div>

<div id="comparison">
  <h2>Comparison Panel</h2>
  <div>
    Select up to 5 profiles:
    <select id="compare-select" multiple size="5" style="width:200px;"></select>
  </div>
  <div class="selected-profiles" id="selected-profiles"></div>
</div>

<script>
const fields = ['G','R','Y','B','O','Star Power','Open Notes'];
let profilesData = [];

async function loadProfiles() {
  const res = await fetch('scan_summary.json');
  const data = await res.json();
  profilesData = data.color_profiles.map((name, i) => {
    const profileData = data.color_profiles_data ? data.color_profiles_data[name] : null;
    return {
      name: name.replace(/\..+$/, ''),
      colors: profileData ? profileData : fields.reduce((obj,f)=>{obj[f]='';return obj},{})
    };
  });
  renderIndex();
  renderProfiles();
  renderComparisonSelect();
}

function renderIndex() {
  const indexContainer = document.getElementById('index');
  const letters = [...'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'];
  letters.forEach(l => {
    const btn = document.createElement('button');
    btn.textContent = l;
    btn.onclick = () => {
      const el = document.querySelector(`.profile-row[data-letter="${l}"]`);
      if(el) el.scrollIntoView({behavior:'smooth', block:'start'});
    };
    indexContainer.appendChild(btn);
  });
}

function renderProfiles() {
  const container = document.getElementById('profiles');
  let lastLetter = '';
  profilesData.sort((a,b) => a.name.localeCompare(b.name));
  profilesData.forEach(p => {
    const firstChar = p.name[0].toUpperCase();
    const row = document.createElement('div');
    row.className = 'profile-row';
    row.dataset.letter = firstChar;

    if(firstChar !== lastLetter) row.style.marginTop = '15px';
    lastLetter = firstChar;

    const nameDiv = document.createElement('div');
    nameDiv.className = 'profile-name';
    nameDiv.textContent = p.name;
    row.appendChild(nameDiv);

    fields.forEach(f => {
      const sw = document.createElement('div');
      sw.className = 'swatch';
      sw.style.backgroundColor = p.colors[f] || '#333';
      if(!p.colors[f]) sw.textContent = 'X';
      row.appendChild(sw);
    });
    container.appendChild(row);
  });
}

function renderComparisonSelect() {
  const select = document.getElementById('compare-select');
  profilesData.forEach(p => {
    const opt = document.createElement('option');
    opt.value = p.name;
    opt.textContent = p.name;
    select.appendChild(opt);
  });

  select.onchange = () => {
    const selected = Array.from(select.selectedOptions).slice(0,5).map(o => o.value);
    const display = document.getElementById('selected-profiles');
    display.innerHTML = '';
    selected.forEach(name => {
      const p = profilesData.find(pr => pr.name === name);
      const colDiv = document.createElement('div');
      colDiv.className = 'compare-row';
      const label = document.createElement('div');
      label.textContent = p.name;
      colDiv.appendChild(label);
      fields.forEach(f=>{
        const sw = document.createElement('div');
        sw.className='swatch';
        sw.style.backgroundColor = p.colors[f] || '#333';
        if(!p.colors[f]) sw.textContent = 'X';
        colDiv.appendChild(sw);
      });
      display.appendChild(colDiv);
    });
  };
}

loadProfiles();
</script>
</body>
</html>
